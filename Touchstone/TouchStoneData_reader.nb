(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47524,       1204]
NotebookOptionsPosition[     42846,       1121]
NotebookOutlinePosition[     43279,       1138]
CellTagsIndexPosition[     43236,       1135]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.928997498149965*^9, 3.928997504277038*^9}, {
  3.953290833709663*^9, 3.953290836016114*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"ac3b2490-657d-45b6-940f-d49f955cc646"],

Cell[CellGroupData[{

Cell["Touchstone data importer", "Title",
 CellChangeTimes->{{3.9294166050717025`*^9, 
  3.929416620487073*^9}},ExpressionUUID->"a70b0adb-9a13-4616-931e-\
ccf385a4bf21"],

Cell[CellGroupData[{

Cell["Import and Parsing", "Section",
 CellChangeTimes->{{3.929417381486686*^9, 
  3.929417386470392*^9}},ExpressionUUID->"18dfa17a-d61f-45dc-afaf-\
50152e62a272"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "filepath", "=", 
   "\"\<C:\\\\Users\\\\Administrator\\\\offline\\\\Radon_Back_End\\\\sim\\\\\
SI\\\\TUNING\\\\res\\\\sol_1_terminated.s1p\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.929417348297481*^9, 3.929417360407211*^9}, {
   3.929496902630663*^9, 3.9294969230313487`*^9}, {3.929498786322449*^9, 
   3.9294987911482725`*^9}, {3.9306443709578047`*^9, 3.93064437197241*^9}, {
   3.9309077433636208`*^9, 3.930907745443445*^9}, {3.930909199027952*^9, 
   3.93090919912008*^9}, {3.930909242005424*^9, 3.930909242129558*^9}, 
   3.930909313777824*^9, {3.9309096704328203`*^9, 3.930909670606106*^9}, {
   3.930909770235169*^9, 3.9309097998884*^9}, 3.931255117797702*^9, 
   3.93140977983889*^9, 3.9314099128917828`*^9, 3.931410228936171*^9, {
   3.931410273307474*^9, 3.9314102734140577`*^9}, {3.934351378877249*^9, 
   3.934351387836933*^9}, {3.935559423785325*^9, 3.935559441861609*^9}, {
   3.935559670777514*^9, 3.935559670895281*^9}, {3.935567805118121*^9, 
   3.9355678055060883`*^9}, 3.935568950596405*^9, {3.935569022691498*^9, 
   3.9355690241709547`*^9}, {3.935569199457051*^9, 3.935569199942173*^9}, {
   3.935569285464945*^9, 3.935569285631019*^9}, {3.935573689657539*^9, 
   3.935573727817576*^9}, {3.935574527925211*^9, 3.935574528052305*^9}, {
   3.9355745753958797`*^9, 3.935574575484084*^9}, {3.935576371482791*^9, 
   3.9355763716024857`*^9}, {3.9356439808069973`*^9, 3.935643981679793*^9}, {
   3.935667036847862*^9, 3.935667037532187*^9}, {3.935668255448485*^9, 
   3.935668255554997*^9}, {3.935668363154858*^9, 3.935668363285088*^9}, {
   3.935668444549787*^9, 3.935668444826236*^9}, {3.9357305852192307`*^9, 
   3.935730615304378*^9}, 3.935738211216325*^9, {3.9357383576416817`*^9, 
   3.935738357792224*^9}, {3.9358360979358473`*^9, 3.9358360981495943`*^9}, {
   3.936084179809265*^9, 3.936084201655519*^9}, {3.936085773161553*^9, 
   3.936085817240498*^9}, {3.93608609250572*^9, 3.936086111396266*^9}, {
   3.936088411473733*^9, 3.936088439326687*^9}, 3.9360884790017133`*^9, 
   3.936092871097501*^9, {3.936092947810055*^9, 3.9360929480430717`*^9}, {
   3.936094620026398*^9, 3.9360946201655197`*^9}, 3.936094701241781*^9, 
   3.936161871780047*^9, 3.936162038351231*^9, {3.936162078600401*^9, 
   3.936162079493927*^9}, {3.936176426659494*^9, 3.936176426759136*^9}, 
   3.936176494775929*^9, 3.936176881062646*^9, 3.953289274442724*^9, {
   3.9543540642017593`*^9, 3.954354068726764*^9}, {3.954356584263012*^9, 
   3.954356584854184*^9}, {3.954356675289165*^9, 3.954356682708527*^9}, {
   3.954680317784609*^9, 3.9546803207914352`*^9}, {3.954680887032381*^9, 
   3.9546808957897396`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"7d4872ff-52d7-4278-9495-68a8752b5122"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "there", " ", "is", " ", "not", " ", "a", " ", "smarter", " ", "way", " ", 
   "to", " ", "identify", " ", "the", " ", "number", " ", "of", " ", "ports", 
   " ", "on", " ", "the", " ", "touchstone", " ", "file", " ", "yet"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9543564021843348`*^9, 3.95435643083215*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"6992abef-7d2c-4568-b98d-128fe90ea9c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nPorts", "=", 
  RowBox[{
   RowBox[{"ToExpression", "[", 
    RowBox[{"StringCases", "[", 
     RowBox[{
      RowBox[{"FileExtension", "[", "filepath", "]"}], ",", 
      RowBox[{
       RowBox[{"\"\<s\>\"", "~~", "x__", "~~", "\"\<p\>\""}], ":>", "x"}]}], 
     "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.95435643729416*^9, 3.954356452205768*^9}, {
  3.954356573759974*^9, 3.954356605642147*^9}, {3.954356652913155*^9, 
  3.954356691381745*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"f7673ba9-f216-4be4-a365-89ca69059f9b"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.9543566916746473`*^9, 3.954357005242548*^9, 
  3.954357080770465*^9, 3.954680322950617*^9, 3.9546808968311768`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"7066e918-7a2d-254a-8ccf-110262ae1eab"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TSFileRaw", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"filepath", ",", "\"\<Table\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TSFileRawCommentCleaned", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"TSFileRaw", ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"Not", "[", 
         RowBox[{"StringStartsQ", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<!\>\""}], "]"}], "]"}], 
        ",", "True"}], "]"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TSFileHeader", "=", 
   RowBox[{"TSFileRawCommentCleaned", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TSDataRaw", "=", 
   RowBox[{
    RowBox[{"TSFileRawCommentCleaned", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;"}], "]"}], "]"}], "//", "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.929417368646389*^9, 3.929417375575108*^9}, {
  3.9294176319899907`*^9, 3.9294176641350174`*^9}, {3.929418664973985*^9, 
  3.929418665199858*^9}, {3.929496984567421*^9, 3.929497000904191*^9}, {
  3.953289387694141*^9, 3.95328939578736*^9}, {3.953289600611429*^9, 
  3.953289614859301*^9}, {3.953289702111211*^9, 3.953289766810622*^9}, {
  3.953289810954269*^9, 3.953289813040841*^9}, {3.953289846230681*^9, 
  3.953289852794193*^9}, {3.953289890430337*^9, 3.953289897024131*^9}, {
  3.953289956453339*^9, 3.953289975523553*^9}, {3.953290128936494*^9, 
  3.953290207566859*^9}, {3.9532903267634583`*^9, 3.953290369727755*^9}, {
  3.953290529038644*^9, 3.9532905340253687`*^9}, {3.953290695440256*^9, 
  3.953290706268057*^9}, {3.954356702958977*^9, 3.954356710997026*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"a08180f5-5bd9-4c26-ac98-8fc3e8edf302"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TSData", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"TSDataRaw", ",", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"nPorts", "^", "2"}], ")"}]}], "+", "1"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.95435674784003*^9, 3.954356772480777*^9}, {
  3.954357016528318*^9, 3.9543570198196983`*^9}, {3.954357055182455*^9, 
  3.954357064070915*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"0dda6b08-ab36-4565-9fc3-bd393304ccac"],

Cell[CellGroupData[{

Cell[BoxData["TSFileHeader"], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"6cc08f59-bfd5-43b9-acb9-3135ea95a6ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"#\"\>", ",", "\<\"GHz\"\>", ",", "\<\"S\"\>", 
   ",", "\<\"MA\"\>", ",", "\<\"R\"\>", ",", "50.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.953348646254737*^9, 3.953356484053046*^9, 3.953381680167993*^9, 
   3.953381791792644*^9, 3.953383793620476*^9, 3.95338385764304*^9, {
   3.954354074547505*^9, 3.954354093308625*^9}, 3.9543570053107653`*^9, 
   3.954357080839157*^9, 3.954680323141918*^9, 3.954680896862095*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"8b6cb748-754a-5b4e-b4f2-bc0cc7ac0388"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Z0", "=", 
  RowBox[{"TSFileHeader", "[", 
   RowBox[{"[", 
    RowBox[{"-", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.929417666432388*^9, 3.929417679430334*^9}, {
  3.929418460958606*^9, 3.929418468990579*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"e8a2104e-14f9-4411-8848-bd81f2945e44"],

Cell[BoxData["50.`"], "Output",
 CellChangeTimes->{{3.929418461229953*^9, 3.9294184700949173`*^9}, 
   3.9294193223711243`*^9, 3.929496231992309*^9, {3.9294969123022976`*^9, 
   3.929496930051299*^9}, {3.9294970033602333`*^9, 3.9294970340933237`*^9}, 
   3.929497767641049*^9, 3.9294978138000603`*^9, 3.929498793028172*^9, 
   3.9294988575348043`*^9, {3.929499261315987*^9, 3.92949927446719*^9}, 
   3.929499746740941*^9, 3.929503849705955*^9, {3.930644375429387*^9, 
   3.930644396670927*^9}, 3.930644497336639*^9, {3.930645077328877*^9, 
   3.930645087481052*^9}, 3.9306487265420933`*^9, 3.930907747650092*^9, 
   3.930907919340065*^9, 3.930908645326367*^9, 3.930908818214437*^9, 
   3.930909003457473*^9, 3.930909199844812*^9, 3.9309092450788603`*^9, 
   3.930909318327302*^9, 3.930909671447358*^9, 3.930909724214314*^9, {
   3.930909772570994*^9, 3.93090980104136*^9}, 3.93125514428221*^9, 
   3.931255523553254*^9, 3.931255586459721*^9, 3.931409375955785*^9, 
   3.931409780398395*^9, {3.931409913435977*^9, 3.931409918271741*^9}, 
   3.931410234733274*^9, 3.931410274629531*^9, 3.9343513894987373`*^9, 
   3.934351422963545*^9, 3.934352439989082*^9, 3.934353045587309*^9, 
   3.9355594432642527`*^9, 3.935559671605894*^9, 3.935560009277173*^9, 
   3.935567806229772*^9, 3.935568292922975*^9, 3.935568953234859*^9, {
   3.935569025683337*^9, 3.93556905355616*^9}, 3.935569128696443*^9, 
   3.935569201938156*^9, 3.935569286408955*^9, {3.9355727857001877`*^9, 
   3.9355727940450373`*^9}, {3.935573690625898*^9, 3.935573729008506*^9}, 
   3.935574528780059*^9, 3.935574576233432*^9, 3.935575272984172*^9, 
   3.93557637365125*^9, {3.935643984440269*^9, 3.935644000701097*^9}, {
   3.935664819617052*^9, 3.935664825633477*^9}, 3.9356667799467793`*^9, 
   3.935667038938401*^9, 3.935668256753376*^9, 3.935668364236456*^9, 
   3.935668445584049*^9, {3.935730586949946*^9, 3.935730616485304*^9}, 
   3.9357313872456636`*^9, 3.935738171478272*^9, 3.9357382117444777`*^9, 
   3.935738369163743*^9, 3.935836099366551*^9, 3.936074006414089*^9, 
   3.936074832479516*^9, {3.936084181556937*^9, 3.936084207579039*^9}, {
   3.936085774267435*^9, 3.936085818219153*^9}, {3.936086094233097*^9, 
   3.936086111993288*^9}, {3.936088413243307*^9, 3.936088440198345*^9}, 
   3.936088480567606*^9, 3.936091939579848*^9, 3.936092871851425*^9, 
   3.936092948883132*^9, 3.936094481755814*^9, 3.936094621391986*^9, 
   3.936094702416551*^9, 3.936161873471525*^9, 3.936162039558051*^9, 
   3.936162081644445*^9, 3.936175235873673*^9, 3.936176352322377*^9, 
   3.9361764279963627`*^9, 3.936176495912519*^9, 3.93617688286272*^9, {
   3.953289276802312*^9, 3.953289299704234*^9}, {3.953290716288457*^9, 
   3.953290718468178*^9}, 3.953290836948556*^9, 3.9533486462627587`*^9, 
   3.953356484062508*^9, 3.953381680175557*^9, 3.953381791799146*^9, 
   3.953383793628264*^9, 3.953383857649632*^9, {3.954354074550917*^9, 
   3.954354093315877*^9}, 3.954357005313225*^9, 3.954357080841449*^9, 
   3.954680323146904*^9, 3.9546808968670807`*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"8ec1168f-466d-de4f-b8ab-6f76ceac02ca"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Y0", "=", 
   RowBox[{"1", "/", "Z0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.930644384137224*^9, 3.9306443923883743`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"35c395fe-c787-47e0-a137-88b68f578132"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FreqMag", "=", 
   RowBox[{"Switch", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TSFileHeader", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "//", "ToUpperCase"}], ",", 
     "\"\<HZ\>\"", ",", "0", ",", "\"\<KHZ\>\"", ",", "3", ",", "\"\<MHZ\>\"",
      ",", "6", ",", "\"\<GHZ\>\"", ",", "9"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TSData", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"TSData", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", "1"}], "]"}], "]"}], "*", 
    RowBox[{"10", "^", "FreqMag"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.929418476984026*^9, 3.929418525974905*^9}, {
  3.929418561717842*^9, 3.929418597743636*^9}, {3.9294186432227345`*^9, 
  3.929418696134867*^9}, {3.929419105861821*^9, 3.9294191068076673`*^9}, {
  3.929419175669859*^9, 3.929419223254517*^9}, {3.929419980702259*^9, 
  3.929419992238302*^9}, {3.929497007088548*^9, 3.929497009138604*^9}, {
  3.92949769051229*^9, 3.929497692496561*^9}, {3.929497760241511*^9, 
  3.929497761559683*^9}, {3.929497794536348*^9, 3.929497795735399*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"045fd43b-6036-47f5-a8bb-98b38d8db587"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"MA", ":", " ", 
    RowBox[{
     RowBox[{"Magnitude", "/", "Degrees"}], " ", "Angle", 
     "\[IndentingNewLine]", "RI"}], ":", " ", 
    RowBox[{"Real", "/", "Imaginary"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"DataType", "=", 
   RowBox[{
    RowBox[{"TSFileHeader", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "ToUpperCase"}]}]}]], "Input",
 CellChangeTimes->{{3.9294192302775497`*^9, 3.929419315197691*^9}, {
  3.92949687037656*^9, 3.9294968711272097`*^9}, {3.929497013464485*^9, 
  3.929497015987147*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"478e588b-8e6f-43f2-be68-b8cdce52a43a"],

Cell[BoxData["\<\"MA\"\>"], "Output",
 CellChangeTimes->{
  3.9294192802378473`*^9, {3.9294193166915784`*^9, 3.9294193223820953`*^9}, 
   3.929419491328481*^9, 3.929496232016239*^9, {3.9294969123647738`*^9, 
   3.9294969300762367`*^9}, {3.929497016296266*^9, 3.9294970341162624`*^9}, 
   3.929497770872713*^9, 3.92949781383296*^9, 3.929498793033158*^9, 
   3.9294988575617332`*^9, {3.9294992613429184`*^9, 3.9294992744731717`*^9}, 
   3.929499746763877*^9, 3.9295038497328835`*^9, 3.9306443966899977`*^9, 
   3.930644497351874*^9, {3.930645077345642*^9, 3.930645087498871*^9}, 
   3.930648726559089*^9, 3.930907747661749*^9, 3.930907919359682*^9, 
   3.930908645343107*^9, 3.930908818231708*^9, 3.930909003473123*^9, 
   3.9309091998647523`*^9, 3.930909245084811*^9, 3.930909318342647*^9, 
   3.93090967145938*^9, 3.930909724227749*^9, {3.930909772583018*^9, 
   3.930909801067883*^9}, 3.931255144294751*^9, 3.931255523567363*^9, 
   3.931255586481161*^9, 3.931409375961615*^9, 3.9314097804102583`*^9, {
   3.931409913441416*^9, 3.931409918277776*^9}, 3.931410234750874*^9, 
   3.931410274648267*^9, 3.934351389588526*^9, 3.9343514229924355`*^9, 
   3.9343524400090313`*^9, 3.934353045609249*^9, 3.935559443276166*^9, 
   3.935559671626766*^9, 3.935560009296081*^9, 3.935567806237253*^9, 
   3.935568292938355*^9, 3.935568953248952*^9, {3.935569025689188*^9, 
   3.9355690535750437`*^9}, 3.935569128708559*^9, 3.9355692019626017`*^9, 
   3.935569286429493*^9, {3.935572785723504*^9, 3.935572794062048*^9}, {
   3.935573690642443*^9, 3.9355737290319653`*^9}, 3.935574528786772*^9, 
   3.935574576254291*^9, 3.935575272997895*^9, 3.935576373666435*^9, {
   3.935643984454606*^9, 3.9356440007159967`*^9}, {3.935664819636389*^9, 
   3.935664825657256*^9}, 3.935666779958715*^9, 3.935667038954239*^9, 
   3.935668256765161*^9, 3.935668364243134*^9, 3.935668445603669*^9, {
   3.935730586955016*^9, 3.935730616490821*^9}, 3.935731387258354*^9, 
   3.9357381714939623`*^9, 3.93573821176032*^9, 3.935738369180091*^9, 
   3.9358360993790884`*^9, 3.9360740064272957`*^9, 3.9360748324909678`*^9, {
   3.936084181565775*^9, 3.936084207585701*^9}, {3.936085774286413*^9, 
   3.936085818235313*^9}, {3.9360860942563133`*^9, 3.936086112004451*^9}, {
   3.936088413257144*^9, 3.936088440215637*^9}, 3.936088480579957*^9, 
   3.936091939598653*^9, 3.936092871871645*^9, 3.936092948901022*^9, 
   3.936094481772598*^9, 3.936094621407169*^9, 3.936094702424461*^9, 
   3.93616187348846*^9, 3.936162039564295*^9, 3.9361620816506767`*^9, 
   3.9361752358989053`*^9, 3.936176352343061*^9, 3.936176428009872*^9, 
   3.936176495921977*^9, 3.936176882871482*^9, 3.953289276973967*^9, 
   3.953290718478935*^9, 3.953290836960387*^9, 3.953348646269734*^9, 
   3.953356484074295*^9, 3.953381680182044*^9, 3.953381791804195*^9, 
   3.953383793636406*^9, 3.953383857660213*^9, {3.9543540745616693`*^9, 
   3.9543540933209333`*^9}, 3.954357005323434*^9, 3.954357080852356*^9, 
   3.9546803231718407`*^9, 3.9546808968920135`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"854c28e6-b1a2-8040-815e-717d8f9ddaf5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"TSFileRaw", ",", "TSFileRawCommentCleaned"}], "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "clean", " ", "memory", " ", "after", " ", "reading", " ", "data"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.9294176977433844`*^9, 3.929417784814164*^9}, {
  3.929418663319741*^9, 3.9294186681417804`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"027db7bc-a603-47f9-afcb-933103f57d83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freq", "=", 
   RowBox[{"TSData", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.929498428072961*^9, 3.929498461577652*^9}, 
   3.954356992213746*^9, {3.954357085471999*^9, 3.954357090276122*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"cbe35022-587b-46c8-8b6a-72c070d7fb75"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data Conversion", "Section",
 CellChangeTimes->{{3.929419482110241*^9, 
  3.9294194837813044`*^9}},ExpressionUUID->"69f5981d-d577-41d2-91c9-\
2bf3117b90f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sReImToComplex", "[", "data_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}], "+", 
       RowBox[{"I", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}]}]}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "-", "1"}], ")"}], "/", "2"}]}],
        "}"}]}], "]"}], "&"}], "/@", "data"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sMaDeToComplex", "[", "data_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}], 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"I", "*", "2", "Pi", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}], 
           "/", "360"}]}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "-", "1"}], ")"}], "/", "2"}]}],
        "}"}]}], "]"}], "&"}], "/@", "data"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sDBToComplex", "[", "data_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}], 
          "/", "20"}], ")"}]}], 
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"I", "*", "2", "Pi", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}], 
           "/", "360"}]}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], "-", "1"}], ")"}], "/", "2"}]}],
        "}"}]}], "]"}], "&"}], "/@", "data"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sAutoToComplex", "[", "data_", "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{"DataType", ",", "\"\<MA\>\"", ",", 
    RowBox[{"sMaDeToComplex", "[", "data", "]"}], ",", "\"\<RI\>\"", ",", 
    RowBox[{"sReImToComplex", "[", "data", "]"}], ",", "\"\<DB\>\"", ",", 
    RowBox[{"sDBToComplex", "[", "data", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.929419630717461*^9, 3.9294197349979086`*^9}, {
  3.9294963315912733`*^9, 3.929496339359892*^9}, {3.9294963825119853`*^9, 
  3.929496469856347*^9}, {3.9294965330160117`*^9, 3.9294965655360093`*^9}, {
  3.9294966047610903`*^9, 3.929496605743256*^9}, {3.9294966985360985`*^9, 
  3.929496730952327*^9}, {3.929496789864417*^9, 3.929496807655864*^9}, {
  3.929497829265145*^9, 3.9294978919197*^9}, {3.929498133776711*^9, 
  3.929498145872686*^9}, {3.929498480056783*^9, 3.92949849204045*^9}, {
  3.930644611507639*^9, 3.9306446118057947`*^9}, {3.930644875744581*^9, 
  3.9306449389278717`*^9}, {3.930645003883401*^9, 3.930645030640577*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"b41e5a9e-fc2c-48bf-95a8-09d4c4e23e34"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transformations", "Section",
 CellChangeTimes->{{3.92941739085438*^9, 
  3.929417392934398*^9}},ExpressionUUID->"0919d0fd-2120-48b6-be1d-\
55e60ed74abe"],

Cell[CellGroupData[{

Cell["S to Z Definitions", "Subsection",
 CellChangeTimes->{{3.929417808262957*^9, 3.9294178100784245`*^9}, {
  3.9294183223981433`*^9, 3.9294183238058195`*^9}, {3.929499303151744*^9, 
  3.929499305104142*^9}},ExpressionUUID->"075b5bd7-3f88-4856-8dec-\
d9960187f717"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"z11", "[", 
    RowBox[{"s11_", ",", "s21_", ",", "s12_", ",", "s22_"}], "]"}], ":=", 
   RowBox[{"Z0", "*", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "s22"}], ")"}]}], "+", 
      RowBox[{"s12", " ", "s21"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "s22"}], ")"}]}], "-", 
      RowBox[{"s12", " ", "s21"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z12", "[", 
    RowBox[{"s11_", ",", "s21_", ",", "s12_", ",", "s22_"}], "]"}], ":=", 
   RowBox[{"Z0", "*", 
    FractionBox[
     RowBox[{"2", "s12"}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "s22"}], ")"}]}], "-", 
      RowBox[{"s12", " ", "s21"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z21", "[", 
    RowBox[{"s11_", ",", "s21_", ",", "s12_", ",", "s22_"}], "]"}], ":=", 
   RowBox[{"Z0", "*", 
    FractionBox[
     RowBox[{"2", "s21"}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "s22"}], ")"}]}], "-", 
      RowBox[{"s12", " ", "s21"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z22", "[", 
    RowBox[{"s11_", ",", "s21_", ",", "s12_", ",", "s22_"}], "]"}], ":=", 
   RowBox[{"Z0", "*", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", "s22"}], ")"}]}], "+", 
      RowBox[{"s12", " ", "s21"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "s22"}], ")"}]}], "-", 
      RowBox[{"s12", " ", "s21"}]}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928997255098558*^9, 3.9289972628761454`*^9}, {
  3.928997328613908*^9, 3.928997330740159*^9}, {3.9289974906611395`*^9, 
  3.9289974950203485`*^9}, {3.929088427433595*^9, 3.929088433480274*^9}, {
  3.929088479168019*^9, 3.929088492879991*^9}, {3.929088619137453*^9, 
  3.929088619799963*^9}, {3.92908865360952*^9, 3.929088856184767*^9}, {
  3.929088892072631*^9, 3.9290888984805975`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"1539bfea-2195-4cfe-8a96-9e9dd9ff1b98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"z11v", "[", "sv_", "]"}], ":=", 
   RowBox[{"z11", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z12v", "[", "sv_", "]"}], ":=", 
   RowBox[{"z12", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z21v", "[", "sv_", "]"}], ":=", 
   RowBox[{"z21", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z22v", "[", "sv_", "]"}], ":=", 
   RowBox[{"z22", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.92949957687383*^9, 3.9294996248878775`*^9}, {
  3.929499656073545*^9, 3.929499658009675*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"eba35c50-3362-4157-a91d-356a0578d6f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["S to Y Definitions", "Subsection",
 CellChangeTimes->{{3.930644472598014*^9, 
  3.93064447644524*^9}},ExpressionUUID->"0fadff0b-5b75-4ec2-a6d5-\
c86d0dd7a057"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"y11", "[", 
    RowBox[{"s11_", ",", "s21_", ",", "s12_", ",", "s22_"}], "]"}], ":=", 
   RowBox[{"Y0", "*", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", "s22"}], ")"}]}], "+", 
      RowBox[{"s12", " ", "s21"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", "s22"}], ")"}]}], "-", 
      RowBox[{"s12", " ", "s21"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y12", "[", 
    RowBox[{"s11_", ",", "s21_", ",", "s12_", ",", "s22_"}], "]"}], ":=", 
   RowBox[{"Y0", "*", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "2"}], "s12"}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", "s22"}], ")"}]}], "-", 
      RowBox[{"s12", " ", "s21"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y21", "[", 
    RowBox[{"s11_", ",", "s21_", ",", "s12_", ",", "s22_"}], "]"}], ":=", 
   RowBox[{"Y0", "*", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "2"}], "s21"}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", "s22"}], ")"}]}], "-", 
      RowBox[{"s12", " ", "s21"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y22", "[", 
    RowBox[{"s11_", ",", "s21_", ",", "s12_", ",", "s22_"}], "]"}], ":=", 
   RowBox[{"Y0", "*", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "s22"}], ")"}]}], "+", 
      RowBox[{"s12", " ", "s21"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "s11"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", "s22"}], ")"}]}], "-", 
      RowBox[{"s12", " ", "s21"}]}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928997255098558*^9, 3.9289972628761454`*^9}, {
  3.928997328613908*^9, 3.928997330740159*^9}, {3.9289974906611395`*^9, 
  3.9289974950203485`*^9}, {3.929088427433595*^9, 3.929088433480274*^9}, {
  3.929088479168019*^9, 3.929088492879991*^9}, {3.929088619137453*^9, 
  3.929088619799963*^9}, {3.92908865360952*^9, 3.929088856184767*^9}, {
  3.929088892072631*^9, 3.9290888984805975`*^9}, {3.930642021731121*^9, 
  3.930642065328271*^9}, {3.930642098314539*^9, 3.930642144470759*^9}, {
  3.9306440585780087`*^9, 3.930644064112335*^9}, {3.930644481785267*^9, 
  3.93064449184851*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"fe2fb338-87f9-43d6-ba8b-a5a7c6b0dd95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"y11v", "[", "sv_", "]"}], ":=", 
   RowBox[{"y11", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y12v", "[", "sv_", "]"}], ":=", 
   RowBox[{"y12", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y21v", "[", "sv_", "]"}], ":=", 
   RowBox[{"y21", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y22v", "[", "sv_", "]"}], ":=", 
   RowBox[{"y22", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.930644553362197*^9, 3.930644562398521*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"57893630-c66b-4498-b46d-570d2bc5cde4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Z to S Definitions", "Subsection",
 CellChangeTimes->{{3.929417808262957*^9, 3.9294178100784245`*^9}, {
  3.9294183223981433`*^9, 3.9294183238058195`*^9}, {3.929499303151744*^9, 
  3.929499305104142*^9}, {3.953355571616311*^9, 
  3.953355573189464*^9}},ExpressionUUID->"c9625533-7b65-4b81-9e8f-\
1f59cdbb75fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"s11", "[", 
    RowBox[{"z11_", ",", "z21_", ",", "z12_", ",", "z22_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z11", "-", "Z0"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"z22", "+", "Z0"}], ")"}]}], "-", 
     RowBox[{"z12", " ", "z21"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z11", "+", "Z0"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"z22", "+", "Z0"}], ")"}]}], "-", 
     RowBox[{"z12", " ", "z21"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s12", "[", 
    RowBox[{"z11_", ",", "z21_", ",", "z12_", ",", "z22_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"2", "Z0", " ", "z12"}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z11", "+", "Z0"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"z22", "+", "Z0"}], ")"}]}], "-", 
     RowBox[{"z12", " ", "z21"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s21", "[", 
    RowBox[{"z11_", ",", "z21_", ",", "z12_", ",", "z22_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"2", "Z0", " ", "z21"}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z11", "+", "Z0"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"z22", "+", "Z0"}], ")"}]}], "-", 
     RowBox[{"z12", " ", "z21"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s22", "[", 
    RowBox[{"z11_", ",", "z21_", ",", "z12_", ",", "z22_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z11", "+", "Z0"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"z22", "-", "Z0"}], ")"}]}], "-", 
     RowBox[{"z12", " ", "z21"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z11", "+", "Z0"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"z22", "+", "Z0"}], ")"}]}], "-", 
     RowBox[{"z12", " ", "z21"}]}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.928997255098558*^9, 3.9289972628761454`*^9}, {
  3.928997328613908*^9, 3.928997330740159*^9}, {3.9289974906611395`*^9, 
  3.9289974950203485`*^9}, {3.929088427433595*^9, 3.929088433480274*^9}, {
  3.929088479168019*^9, 3.929088492879991*^9}, {3.929088619137453*^9, 
  3.929088619799963*^9}, {3.92908865360952*^9, 3.929088856184767*^9}, {
  3.929088892072631*^9, 3.9290888984805975`*^9}, {3.953355615940274*^9, 
  3.95335565043547*^9}, {3.953355744358242*^9, 3.953355783161137*^9}, {
  3.953355872389314*^9, 3.953355888298852*^9}, {3.953355919801366*^9, 
  3.953355949755797*^9}, {3.953356002455052*^9, 3.95335602775851*^9}, {
  3.9533560627947073`*^9, 3.9533560996184483`*^9}, {3.9533562970007257`*^9, 
  3.953356297952164*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"6c710c32-74ed-491b-8e9c-c3f78cc13410"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"s11v", "[", "sv_", "]"}], ":=", 
   RowBox[{"s11", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s12v", "[", "sv_", "]"}], ":=", 
   RowBox[{"s12", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s21v", "[", "sv_", "]"}], ":=", 
   RowBox[{"s21", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s22v", "[", "sv_", "]"}], ":=", 
   RowBox[{"s22", "[", 
    RowBox[{
     RowBox[{"sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"sv", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.92949957687383*^9, 3.9294996248878775`*^9}, {
  3.929499656073545*^9, 3.929499658009675*^9}, {3.9533563542844687`*^9, 
  3.953356364458437*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"ca553274-ea3e-495d-9024-395ac5fc6131"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other Network Params", "Subsection",
 CellChangeTimes->{{3.929417911718842*^9, 
  3.929417917150175*^9}},ExpressionUUID->"759ea0a1-45f2-4a23-a27b-\
f24eda9f74c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zin", "[", 
   RowBox[{"z11_", ",", "z21_", ",", "z12_", ",", "z22_", ",", "zl_"}], "]"}],
   ":=", 
  RowBox[{"z11", "-", 
   FractionBox[
    RowBox[{"z12", " ", "z21"}], 
    RowBox[{"z22", "+", "zl"}]]}]}]], "Input",
 CellChangeTimes->{{3.929091000968087*^9, 3.929091065112809*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"6f3bf60d-6e3e-45e3-bf94-30f08953b89e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Macro Functions", "Subsection",
 CellChangeTimes->{{3.929499284680761*^9, 
  3.929499286615427*^9}},ExpressionUUID->"261dee23-1d43-43b6-8f95-\
6c5c828133bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sToZ", "[", "data_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "//", "Length"}], ")"}], "==", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"z11v", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
         "}"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"z11v", "[", "#", "]"}], ",", 
        RowBox[{"z12v", "[", "#", "]"}], ",", 
        RowBox[{"z21v", "[", "#", "]"}], ",", 
        RowBox[{"z22v", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
   RowBox[{"sAutoToComplex", "[", "data", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.929499290354899*^9, 3.929499292496698*^9}, {
  3.929499397209047*^9, 3.929499455736885*^9}, {3.929499528177905*^9, 
  3.929499556408637*^9}, {3.929499632402398*^9, 3.9294996472328796`*^9}, {
  3.93090847928831*^9, 3.930908602866004*^9}, {3.953383820382984*^9, 
  3.953383823117182*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"3ec21bc6-7020-4827-9087-1154bf3e48f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sToY", "[", "data_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "//", "Length"}], ")"}], "==", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"y11v", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
         "}"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y11v", "[", "#", "]"}], ",", 
        RowBox[{"y12v", "[", "#", "]"}], ",", 
        RowBox[{"y21v", "[", "#", "]"}], ",", 
        RowBox[{"y22v", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
   RowBox[{"sAutoToComplex", "[", "data", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9306445215460587`*^9, 3.93064452176023*^9}, {
  3.930644576419599*^9, 3.930644582215536*^9}, {3.9309086175976667`*^9, 
  3.930908636677745*^9}, {3.953383831030238*^9, 3.9533838333269467`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"82d7325e-9278-4120-b021-1c70164d5330"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zToS", "[", "data_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "//", "Length"}], ")"}], "==", "1"}], ",", 
      RowBox[{"{", 
       RowBox[{"s11v", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
         "}"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s11v", "[", "#", "]"}], ",", 
        RowBox[{"s12v", "[", "#", "]"}], ",", 
        RowBox[{"s21v", "[", "#", "]"}], ",", 
        RowBox[{"s22v", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
   "data"}]}]], "Input",
 CellChangeTimes->{{3.9306445215460587`*^9, 3.93064452176023*^9}, {
  3.930644576419599*^9, 3.930644582215536*^9}, {3.9309086175976667`*^9, 
  3.930908636677745*^9}, {3.953356382389675*^9, 3.953356434607898*^9}, {
  3.95338178684428*^9, 3.9533817901832447`*^9}, {3.953383837347639*^9, 
  3.953383840444091*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"1aa98aee-4e6b-4884-90eb-9d8fed23cdfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"zIn", "[", "dataZ_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"zin", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "50"}], "]"}], "&"}], "/@", 
    RowBox[{"sToZ", "[", "TSData", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.934352266944351*^9, 3.93435228980821*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"dd17ea32-cfb2-d24e-b3f7-bfe698efc347"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.929498445561067*^9, 
  3.9294984465594497`*^9}},ExpressionUUID->"a70d6363-6fc7-400c-a948-\
be5ea095a9ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"conj", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Complex", "[", 
      RowBox[{"re_", ",", "im_"}], "]"}], ":>", 
     RowBox[{"Complex", "[", 
      RowBox[{"re", ",", 
       RowBox[{"-", "im"}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.928997320389413*^9, 3.928997323236489*^9}, 
   3.929418360638968*^9},
 CellLabel->
  "In[112]:=",ExpressionUUID->"2c714f59-f433-4345-b976-f089526d1c16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freqAppend", "[", "v_", "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"freq", ",", "v"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.929498545395314*^9, 3.929498600847697*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"52fcfc76-d78b-4b98-a29c-b7827fc71f0b"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1131, 916},
WindowMargins->{{61, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4ae2abf1-7811-4cf6-8a4d-7ed23b696909"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 295, 5, 35, "Input",ExpressionUUID->"ac3b2490-657d-45b6-940f-d49f955cc646"],
Cell[CellGroupData[{
Cell[878, 29, 169, 3, 122, "Title",ExpressionUUID->"a70b0adb-9a13-4616-931e-ccf385a4bf21"],
Cell[CellGroupData[{
Cell[1072, 36, 163, 3, 83, "Section",ExpressionUUID->"18dfa17a-d61f-45dc-afaf-50152e62a272"],
Cell[1238, 41, 2732, 40, 35, "Input",ExpressionUUID->"7d4872ff-52d7-4278-9495-68a8752b5122"],
Cell[3973, 83, 436, 8, 35, "Input",ExpressionUUID->"6992abef-7d2c-4568-b98d-128fe90ea9c5"],
Cell[CellGroupData[{
Cell[4434, 95, 597, 14, 35, "Input",ExpressionUUID->"f7673ba9-f216-4be4-a365-89ca69059f9b"],
Cell[5034, 111, 244, 3, 40, "Output",ExpressionUUID->"7066e918-7a2d-254a-8ccf-110262ae1eab"]
}, Open  ]],
Cell[5293, 117, 1952, 43, 107, "Input",ExpressionUUID->"a08180f5-5bd9-4c26-ac98-8fc3e8edf302"],
Cell[7248, 162, 499, 13, 35, "Input",ExpressionUUID->"0dda6b08-ab36-4565-9fc3-bd393304ccac"],
Cell[CellGroupData[{
Cell[7772, 179, 117, 1, 35, "Input",ExpressionUUID->"6cc08f59-bfd5-43b9-acb9-3135ea95a6ac"],
Cell[7892, 182, 544, 9, 40, "Output",ExpressionUUID->"8b6cb748-754a-5b4e-b4f2-bc0cc7ac0388"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8473, 196, 327, 7, 35, "Input",ExpressionUUID->"e8a2104e-14f9-4411-8848-bd81f2945e44"],
Cell[8803, 205, 3096, 43, 40, "Output",ExpressionUUID->"8ec1168f-466d-de4f-b8ab-6f76ceac02ca"]
}, Open  ]],
Cell[11914, 251, 240, 5, 35, "Input",ExpressionUUID->"35c395fe-c787-47e0-a137-88b68f578132"],
Cell[12157, 258, 1245, 28, 60, "Input",ExpressionUUID->"045fd43b-6036-47f5-a8bb-98b38d8db587"],
Cell[CellGroupData[{
Cell[13427, 290, 704, 16, 131, "Input",ExpressionUUID->"478e588b-8e6f-43f2-be68-b8cdce52a43a"],
Cell[14134, 308, 3075, 43, 40, "Output",ExpressionUUID->"854c28e6-b1a2-8040-815e-717d8f9ddaf5"]
}, Open  ]],
Cell[17224, 354, 462, 11, 35, "Input",ExpressionUUID->"027db7bc-a603-47f9-afcb-933103f57d83"],
Cell[17689, 367, 373, 8, 35, "Input",ExpressionUUID->"cbe35022-587b-46c8-8b6a-72c070d7fb75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18099, 380, 162, 3, 83, "Section",ExpressionUUID->"69f5981d-d577-41d2-91c9-2bf3117b90f0"],
Cell[18264, 385, 3986, 111, 178, "Input",ExpressionUUID->"b41e5a9e-fc2c-48bf-95a8-09d4c4e23e34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22287, 501, 159, 3, 83, "Section",ExpressionUUID->"0919d0fd-2120-48b6-be1d-55e60ed74abe"],
Cell[CellGroupData[{
Cell[22471, 508, 267, 4, 67, "Subsection",ExpressionUUID->"075b5bd7-3f88-4856-8dec-d9960187f717"],
Cell[22741, 514, 2538, 75, 210, "Input",ExpressionUUID->"1539bfea-2195-4cfe-8a96-9e9dd9ff1b98"],
Cell[25282, 591, 1856, 55, 107, "Input",ExpressionUUID->"eba35c50-3362-4157-a91d-356a0578d6f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27175, 651, 165, 3, 67, "Subsection",ExpressionUUID->"0fadff0b-5b75-4ec2-a6d5-c86d0dd7a057"],
Cell[27343, 656, 2776, 80, 210, "Input",ExpressionUUID->"fe2fb338-87f9-43d6-ba8b-a5a7c6b0dd95"],
Cell[30122, 738, 1806, 54, 107, "Input",ExpressionUUID->"57893630-c66b-4498-b46d-570d2bc5cde4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31965, 797, 316, 5, 67, "Subsection",ExpressionUUID->"c9625533-7b65-4b81-9e8f-1f59cdbb75fb"],
Cell[32284, 804, 2765, 76, 210, "Input",ExpressionUUID->"6c710c32-74ed-491b-8e9c-c3f78cc13410"],
Cell[35052, 882, 1911, 57, 107, "Input",ExpressionUUID->"ca553274-ea3e-495d-9024-395ac5fc6131"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37000, 944, 168, 3, 67, "Subsection",ExpressionUUID->"759ea0a1-45f2-4a23-a27b-f24eda9f74c3"],
Cell[37171, 949, 404, 11, 55, "Input",ExpressionUUID->"6f3bf60d-6e3e-45e3-bf94-30f08953b89e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37612, 965, 163, 3, 67, "Subsection",ExpressionUUID->"261dee23-1d43-43b6-8f95-6c5c828133bd"],
Cell[37778, 970, 1166, 30, 60, "Input",ExpressionUUID->"3ec21bc6-7020-4827-9087-1154bf3e48f5"],
Cell[38947, 1002, 1072, 28, 60, "Input",ExpressionUUID->"82d7325e-9278-4120-b021-1c70164d5330"],
Cell[40022, 1032, 1131, 30, 35, "Input",ExpressionUUID->"1aa98aee-4e6b-4884-90eb-9d8fed23cdfc"],
Cell[41156, 1064, 674, 19, 35, "Input",ExpressionUUID->"dd17ea32-cfb2-d24e-b3f7-bfe698efc347"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41879, 1089, 156, 3, 83, "Section",ExpressionUUID->"a70d6363-6fc7-400c-a948-be5ea095a9ac"],
Cell[42038, 1094, 452, 13, 35, "Input",ExpressionUUID->"2c714f59-f433-4345-b976-f089526d1c16"],
Cell[42493, 1109, 325, 8, 35, "Input",ExpressionUUID->"52fcfc76-d78b-4b98-a29c-b7827fc71f0b"]
}, Open  ]]
}, Open  ]]
}
]
*)

